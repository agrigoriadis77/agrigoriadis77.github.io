<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Schedule Converter</title>
    <style>
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        .controls {
            margin-bottom: 20px;
        }

        .schedule-table {
            border-collapse: collapse;
            width: 100%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .schedule-table th, .schedule-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
            min-width: 150px;
        }

        /* unset min-width for the first th and td */
        .schedule-table th:first-child, .schedule-table td:first-child {
            min-width: unset;
        }

        .schedule-table th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }

        .schedule-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .schedule-table tr:hover {
            background-color: #f1f1f1;
        }

        input[type="file"] {
            margin: 10px 0;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #45a049;
        }

        select {
            padding: 8px;
            margin: 0 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body onload="convert(true)">
<div class="container">
    <div class="controls">
        <input type="file" id="fileInput" accept=".xlsx,.xls">
        <select id="classroomSelect" onchange="convert()">
            <option value="A1">A1</option>
            <option value="A2" selected>A2</option>
            <option value="A3">A3</option>
            <option value="A4">A4</option>
        </select>
    </div>
    <div id="schedule"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    const defaultData = [
        [
            "1ο ΓΥΜΝΑΣΙΟ ΒΡΙΛΗΣΣΙΩΝ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "ΩΡΟΛΟΓΙΟ ΠΡΟΓΡΑΜΜΑ ΔΙΔΑΣΚΟΝΤΩΝ"
        ],
        [
            "Σε ισχύ:27/1/2025",
            null,
            null,
            "ΔΕΥΤΕΡΑ",
            null,
            null,
            null,
            null,
            null,
            null,
            "ΤΡΙΤΗ",
            null,
            null,
            null,
            null,
            null,
            null,
            "ΤΕΤΑΡΤΗ",
            null,
            null,
            null,
            null,
            null,
            null,
            "ΠΕΜΠΤΗ",
            null,
            null,
            null,
            null,
            null,
            null,
            "ΠΑΡΑΣΚΕΥΗ"
        ],
        [
            "α/α",
            "Διδάσκων",
            "ΠΕ",
            "1η",
            "2η",
            "3η",
            "4η",
            "5η",
            "6η",
            "7η",
            "1η",
            "2η",
            "3η",
            "4η",
            "5η",
            "6η",
            "7η",
            "1η",
            "2η",
            "3η",
            "4η",
            "5η",
            "6η",
            "7η",
            "1η",
            "2η",
            "3η",
            "4η",
            "5η",
            "6η",
            "7η",
            "1η",
            "2η",
            "3η",
            "4η",
            "5η",
            "6η"
        ],
        [
            1,
            "ΣΥΡΜΑ ΕΥΑΓΓΕΛΙΑ",
            "ΠΕ02",
            "Α1 ΝεΛ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Α1 ΝεΛ"
        ],
        [
            2,
            "ΜΟΥΡΤΟΠΟΥΛΟΥ ΜΑΡΙΑ",
            "ΠΕ11",
            "Γ1 Γμν",
            "Γ2 Γμν",
            "Α3 Γμν",
            null,
            null,
            null,
            null,
            "Α4 Γμν",
            "Γ2 Γμν",
            null,
            "Γ3 Γμν",
            null,
            null,
            null,
            "Α3 Γμν",
            null,
            null,
            null,
            "Α1 Γμν",
            null,
            null,
            "Α1 Γμν",
            "Α4 Γμν",
            null,
            null,
            "Γ1 Γμν",
            "Γ3 Γμν",
            "Α2 Γμν",
            "Α2 Γμν"
        ],
        [
            3,
            "ΒΑΣΙΛΟΓΙΑΝΝΗ ΕΥΑΓΓΕΛΙΑ",
            "ΠΕ78",
            null,
            null,
            null,
            null,
            null,
            "Γ4 ΚΠΑ",
            "Γ2 ΚΠΑ",
            "Γ5 ΚΠΑ",
            null,
            null,
            null,
            null,
            "Γ1 ΚΠΑ",
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ2 ΚΠΑ",
            "Γ4 ΚΠΑ",
            null,
            "Γ2 ΚΠΑ",
            "Γ4 ΚΠΑ",
            null,
            null,
            "Γ1 ΚΠΑ",
            "Γ5 ΚΠΑ",
            null,
            null,
            "Γ1 ΚΠΑ",
            null,
            null,
            "Γ5 ΚΠΑ"
        ],
        [
            4,
            "ΠΑΠΑΔΟΠΟΥΛΟΥ ΧΡΥΣΗ",
            "ΠΕ01",
            null,
            "Α4 Θρσ",
            "Γ5 Θρσ",
            "Β3 Θρσ",
            null,
            "Β2 Θρσ",
            "Α3 Θρσ",
            null,
            null,
            "Α1 Θρσ",
            null,
            "Γ1 Θρσ",
            "Γ2 Θρσ",
            "Γ4 Θρσ",
            "Γ1 Θρσ",
            "Α1 Θρσ",
            "Α2 Θρσ",
            null,
            "Β4 Θρσ",
            null,
            null,
            null,
            null,
            null,
            "Γ3 Θρσ",
            "Α3 Θρσ",
            "Γ5 Θρσ",
            "Γ2 Θρσ",
            "Α4 Θρσ",
            null,
            "Α2 Θρσ",
            "Γ3 Θρσ",
            "Γ4 Θρσ",
            "Β1 Θρσ"
        ],
        [
            5,
            "ΚΟΝΤΟΝΙΚΑ ΠΑΝΩΡΑΙΑ",
            "ΠΕ02",
            null,
            null,
            null,
            "Β4 Γλω",
            "Β4 ΝΕΛ",
            "Α2 ΝεΛ",
            "Β3 ΓΛ",
            "Α3 ΝεΛ",
            null,
            "Β3 ΓΛ",
            "Β3 ΝΕΛ",
            "Α3 ΑρΚμ",
            null,
            null,
            "Α4 Αρχ Γλ",
            "Α4 ΑρχΚμ",
            "Α3 ΑρΓΛ",
            "Α3 ΝεΛ",
            null,
            null,
            null,
            "Α4 ΑρχΚμ",
            "Β3 ΝεΛ",
            "Α3 ΑρχΚΜ",
            "Β4 ΓΛ",
            null,
            null,
            null,
            null,
            "Α2 ΝεΛ",
            "Β4 ΝεΛ",
            null,
            "Α3 ΑρχΓλ",
            "Α4 ΑρχΓλ"
        ],
        [
            6,
            "ΜΑΚΡΗ ΜΑΡΙΑ",
            "ΠΕ02",
            null,
            "Α3 Γλω",
            "Γ4 ΑρχΚμ",
            null,
            "A2 Γλω",
            "Β3 Ιστ",
            null,
            "Β4 Ιστ",
            null,
            "Α3 Γλω",
            "Γ5 ΑΡΧΚ",
            "Γ5 ΑρχΓλ",
            null,
            null,
            null,
            null,
            null,
            "Γ5 ΑρχΚμ",
            "Γ4 ΑρχΚμ",
            "Β3 Ιστ",
            "Β4 Ιστ",
            "Γ5 ΝΕΛ",
            "Γ4 ΑρχΓλ",
            "Α2 Γλω",
            "Α3 Γλω",
            null,
            null,
            null,
            null,
            null,
            "Γ5 ΑρχΓλ",
            "Γ5 ΝΕΛ",
            "Α2 Γλω",
            "Γ4 ΑρχΓλ"
        ],
        [
            7,
            "ΤΣΙΛΙΚΟΥ ΣΤΑΜΑΤΙΝΑ",
            "ΠΕ02",
            null,
            "Β3 ΑρχΓλ",
            null,
            "Β1 ΑρχΓλ",
            "Γ3 ΝΕΛ",
            null,
            null,
            null,
            "Α1 Ιστ",
            "Γ3 Γλω",
            null,
            "Γ3 Γλω",
            "Α2 Ιστ",
            "Β2 ΑρχΓλ",
            "Β4 ΑρχΓλ",
            "Α2 Ιστ",
            null,
            "Γ3 ΝεΛ",
            "Β1 ΑρχΓλ",
            null,
            null,
            "Γ2 Ιστ",
            "Β4 ΑρχΓλ",
            "Γ5 Γλω",
            "Α1 Ιστ",
            null,
            null,
            null,
            null,
            "Γ5 Γλω",
            "Β2 ΑρΓλ",
            "Β3 ΑρχΓλ",
            null,
            "Γ2 Ιστ"
        ],
        [
            8,
            "ΑΝΔΡΕΟΥ ΧΡΙΣΤΙΝΑ",
            "ΠΕ02",
            "Γ3 ΑρχΓΚμ",
            null,
            "Β2 Ιστ",
            "Γ1 ΑρχΚμ",
            null,
            "Α4 Γλω",
            "Γ1 ΑρχΓλ",
            null,
            "Α4 Γλω",
            null,
            "Α4 Γλω",
            "Γ2 ΑρχΓλ",
            "Γ3 ΑρχΚμ",
            null,
            null,
            null,
            null,
            null,
            "Γ2 ΑρχΚμ",
            "Α4 ΝεΛ",
            "Γ2 ΑρχΓλ",
            "Γ1 ΑρχΚμ",
            "Β1 Ιστ",
            "Β2 Ιστ",
            "Α4 ΝεΛ",
            null,
            null,
            null,
            null,
            null,
            "Β1 Ιστ",
            null,
            "Γ2 ΑρχΚμ",
            "Γ1 ΑρχΓλ"
        ],
        [
            9,
            "ΠΑΠΑΔΟΠΟΥΛΟΥ ΑΝΑΣΤΑΣΙΑ",
            "ΠΕ02",
            "Α2 ΑρχΓλ",
            "Β2 Γλω",
            "Β4 ΑρχΚμ",
            null,
            "Β2 Γλω",
            null,
            null,
            "Α1 ΑρχΚμ",
            null,
            "Α2 ΑρχΚμ",
            "Α1 ΑρχΓλ",
            "Β1 ΝεΛ",
            null,
            null,
            null,
            "Β3 ΑρχΚμ",
            "Β4 ΑρχΚμ",
            "Β2 ΝεΛ",
            null,
            "Β1 ΝεΛ",
            null,
            "Α2 ΑρχΚμ",
            "Β2 ΝεΛ",
            "Β1 Γλω",
            "Β1 Γλω",
            null,
            null,
            null,
            "Β3 ΑρχΚμ",
            "Α1 ΑρχΚμ",
            null,
            "Α2 ΑρχΓλ",
            null,
            "Α1 ΑρχΓλ"
        ],
        [
            10,
            "ΔΙΑΚΟΥΜΗ ΙΩΑΝΝΑ",
            "ΠΕ02",
            "Γ4 Ιστ",
            "Β1 ΑρχΚμ",
            "Α4 Ιστ",
            "Α3 Ιστ",
            null,
            null,
            null,
            null,
            null,
            "Β1 ΑρχΚμ",
            "Γ1 ΝεΛ",
            null,
            "Α4 Ιστ",
            "Γ2 ΝεΛ",
            null,
            null,
            null,
            "Γ2 ΝεΛ",
            "Β2 ΑρχΚμ",
            "Α3 Ιστ",
            "Γ5 Ιστ",
            "Γ4 Ιστ",
            "Γ1 ΝεΛ",
            "Γ2 Γλω",
            "Γ2 Γλω",
            null,
            null,
            null,
            "Γ1 Γλω",
            "Γ1 Γλω",
            null,
            "Β2 ΑρχΚμ",
            "Γ5 Ιστ"
        ],
        [
            11,
            "ΝΙΚΟΛΟΠΟΥΛΟΥ ΕΛΕΝΗ",
            "ΠΕ02",
            null,
            null,
            "Γ1 Ιστ",
            "Α1 Γλω",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Α1 Γλω",
            "Γ1 Ιστ",
            "Α1 Γλω"
        ],
        [
            12,
            "ΠΑΠΑΝΤΩΝΙΟΥ ΚΥΡΙΑΚΗ",
            "ΠΕ02",
            null,
            null,
            "Γ3 ΚΠΑ",
            "Γ3 ΑρχΓλ",
            null,
            "Γ3 ΚΠΑ",
            "Γ4 ΝεΛ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ4 Γλω",
            "Γ4 ΝΕΛ",
            "Γ4 Γλω",
            null,
            "Γ3 ΚΠΑ",
            null,
            "Γ3 ΑρχΓλ"
        ],
        [
            13,
            "ΓΚΟΥΒΑΣ ΑΝΑΣΤΑΣΙΟΣ",
            "ΠΕ03",
            "Β2 Μαθ",
            "Α1 Μαθ",
            "Β3 Μαθ",
            null,
            "Α1 Φσκ",
            "Α3 Φσκ",
            null,
            "Β2 Μαθ",
            "Β4 Μαθ",
            null,
            null,
            "Α2 Μαθ",
            "Β3 Μαθ",
            null,
            "Α2 Μαθ",
            "Β4 Μαθ",
            "Α1 Μαθ",
            null,
            null,
            null,
            null,
            "Β4 Μαθ",
            "Α2 Μαθ",
            null,
            "Β3 Μαθ",
            "Β2 Μαθ",
            "Α2 Φσκ",
            "Α1 Μαθ",
            "Β4 Μαθ",
            "Β2 Μαθ",
            null,
            "Α1 Μαθ",
            "Β3 Μαθ",
            "Α2 Μαθ"
        ],
        [
            14,
            "ΜΠΟΛΕΤΗ ΚΩΣΤΟΥΛΑ",
            "ΠΕ03",
            "Β1 Μαθ",
            "Γ4 Μαθ",
            null,
            "Α3 Μαθ",
            "Β1 Μαθ",
            "Γ5 Μαθ",
            "Α4 Μαθ",
            null,
            "Γ4 Μαθ",
            "Γ5 Μαθ",
            null,
            "Α4 Μαθ",
            "Α3 Μαθ",
            null,
            "Γ5 Μαθ",
            "Α3 Μαθ",
            "Β1 Μαθ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Α4 Μαθ",
            "Γ4 Μαθ",
            "Β1 Μαθ",
            "Γ5 Μαθ",
            "Γ4 Μαθ",
            "Α3 Μαθ",
            null,
            "Α4 Μαθ"
        ],
        [
            15,
            "ΤΣΙΤΙΡΙΔΟΥ ΧΡΥΣΟΥΛΑ",
            "ΠΕ03",
            "Γ2 Μαθ",
            "Γ1 Μαθ",
            null,
            "Γ2 Μαθ",
            "Γ1 Φσκ",
            null,
            "Γ3 Μαθ",
            "Γ1 Μαθ",
            "Γ1 Μαθ",
            "Γ2 Μαθ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ3 Μαθ",
            "Γ3 Μαθ",
            null,
            "Γ1 Μαθ",
            "Γ2 Μαθ",
            null,
            null,
            "Γ3 Φσκ",
            "Γ3 Φσκ",
            "Γ3 Μαθ",
            "Γ1 Φσκ"
        ],
        [
            16,
            "ΣΑΛΑΡΗ ΝΙΚΗ",
            "ΠΕ04.02",
            "Α4 Φσκ",
            null,
            null,
            "Γ5 Φσκ",
            "Γ2 Φσκ",
            "Γ2 Χημ",
            "Β2 Φσκ",
            "Γ2 Φσκ",
            "Γ5 Φσκ",
            "Γ4 Φσκ",
            "Β1 Φσκ",
            null,
            null,
            null,
            null,
            null,
            "Β3 Φσκ",
            "Β4 Φσκ",
            null,
            "Γ1 Χημ",
            "Β1 Φσκ",
            "Β2 Φσκ",
            "Γ5 Χημ",
            null,
            "Γ4 Χημ",
            "Β1 Χημ",
            "Β3 Φσκ",
            "Γ3 Χημ",
            null,
            null,
            "Β3 Χημ",
            "Γ4 Φσκ",
            "Β2 Χημ",
            "Β4 Φσκ"
        ],
        [
            17,
            "ΛΙΟΛΙΟΥ ΕΛΕΝΗ",
            "ΠΕ04.04",
            "Β4 Βιο",
            "Γ5 Βιο",
            null,
            "Α4 Βιο",
            null,
            null,
            null,
            "Γ3 Βιο",
            "Β1 Γεω",
            "Β2 Γεω",
            null,
            null,
            null,
            null,
            null,
            "Β1 Βιο",
            "Γ1 Βιο",
            "Α2 Βιο",
            null,
            "Γ4 Βιο",
            "Α3 Γεω",
            "Β3 Βιο",
            null,
            "Β4 Χημ",
            "Β2 Γεω",
            "Α1 Βιο",
            "Β2 Βιο",
            "Β4 Γεω",
            "Β1 Γεω",
            "Γ2 Βιο",
            null,
            "Β4 Γεω",
            null,
            "Α3 Βιο"
        ],
        [
            18,
            "ΚΟΥΚΛΟΥΜΠΕΡΗ ΔΕΣΠΟΙΝΑ",
            "ΠΕ23"
        ],
        [
            19,
            "ΜΕΤΑΛΛΕΙΝΟΥ ΕΙΡΗΝΗ",
            "ΠΕ05",
            "Β3 Γαλ",
            "Α2 Γαλ",
            "Γ2 Γαλ",
            null,
            null,
            null,
            null,
            null,
            "Α2 Γαλ",
            "Β4 Γαλ",
            null,
            "Α1Γαλ Γαλ",
            "Β2 Γαλ",
            "Γ13Γαλ Γαλ",
            "Β2 Γαλ",
            null,
            "Α4 Γαλ",
            null,
            "Β3 Γαλ",
            "Β4 Γαλ",
            null,
            "Α3 Γαλ",
            "Α1 Γαλ",
            "Γ13 Γαλ",
            null,
            "Γ4 Γαλ",
            "Γ2 Γαλ",
            null,
            "Α3 Γαλ",
            "Α4 Γαλ",
            "Γ4 Γαλ"
        ],
        [
            20,
            "ΚΑΝΕΛΛΟΠΟΥΛΟΥ ΚΩΝΣΤΑΝΤΙΝΑ",
            "ΠΕ05",
            "Γ5 Γαλ",
            "Γ3 Ιστ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ3 Ιστ",
            "Γ5 Γαλ"
        ],
        [
            21,
            "ΑΠΟΣΤΟΛΟΠΟΥΛΟΥ ΝΙΚΟΛΕΤΤΑ",
            "ΠΕ06",
            null,
            null,
            null,
            null,
            "Α4 Αγγ",
            "Β1 Αγγ",
            "Α2 Αγγ",
            null,
            "Β2 Αγγ",
            null,
            "Α3 Αγγ",
            "Γ4 Αγγ",
            "Β4 Αγγ",
            "Β3 Αγγ",
            null,
            null,
            "Β2 Αγγ",
            null,
            "Α2 Αγγ",
            "Γ5 Αγγ",
            "Α1 Αγγ",
            null,
            null,
            "Β3 Αγγ",
            null,
            "Γ5 Αγγ",
            "Α3 Αγγ",
            "Γ4 Αγγ",
            "Α1 Αγγ",
            "Β1 Αγγ",
            null,
            "Α4 Αγγ",
            "Β4 Αγγ"
        ],
        [
            22,
            "ΓΙΑΤΡΑ ΔΙΟΝΥΣΙΑ",
            "ΠΕ06",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ2 Αγγ",
            "Γ3 Αγγ",
            "Γ2 Αγγ",
            "Γ1 Αγγ",
            null,
            "Γ3 Αγγ",
            "Γ1 Αγγ"
        ],
        [
            23,
            "ΓΚΟΥΒΕΛΟΣ ΚΩΝΣΤΑΝΤΙΝΟΣ",
            "ΠΕ07",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Α1Γερ Γερ",
            "Β1 Γερ",
            "Γ13Γερ Γερ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Β1 Γερ",
            "Α1 Γερ",
            "Γ13Γερ Γερ"
        ],
        [
            24,
            "ΜΠΑΛΩΜΕΝΟΥ ΑΙΚΑΤΕΡΙΝΗ",
            "ΠΕ08",
            null,
            null,
            "Α2 Καλ",
            "Α2 Εργ",
            null,
            "Α1 Καλ",
            null,
            "Γ4 Καλ",
            "Γ3 Καλ",
            "Γ1 Καλ",
            "Β2 Εργ",
            null,
            null,
            null,
            "Β3 Καλ",
            "Β2 Καλ",
            "Γ5 Καλ",
            null,
            "Α3 Καλ",
            null,
            null,
            null,
            null,
            "Α4 Εργ",
            null,
            "Β4 Καλ",
            "Α1 Εργ",
            "Α3 Εργ",
            null,
            null,
            "Α4 Καλ",
            "Γ2 Καλ",
            "Β1 Καλ"
        ],
        [
            25,
            "ΔΡΑΚΑΚΗΣ ΓΕΩΡΓΙΟΣ",
            "ΠΕ11",
            null,
            null,
            null,
            "Γ4 Γμν",
            "Β3 Γμν",
            "Β4 Γμν",
            "Β1 Γμν",
            null,
            null,
            null,
            "Β4 Γμν",
            "Β2 Γμν",
            "Γ4 Γμν",
            "Γ5 Γμν",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ5 Γμν",
            "Β3 Γμν",
            "Β1 Γμν",
            "Β2 Γμν"
        ],
        [
            26,
            "ΑΝΤΩΝΟΠΟΥΛΟΥ ΠΑΡΑΣΚΕΥΗ",
            "ΠΕ78",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Α2ΠΤ1 Οικ",
            "Α3ΠΤ1 Οικ",
            "Α4ΠΤ2 Οικ",
            "Α2 Γεω",
            null,
            "Α1ΠΤ1 Οικ",
            null,
            null,
            null,
            null,
            "Β3 Γεω",
            "Α4ΠΤ1 Οικ",
            "Α2ΠΤ2 Οικ",
            "Α4 Γεω",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Α1ΠΤ2 Οικ",
            "Α3ΠΤ2 Οικ",
            "Α1 Γεω",
            "Β3 Γεω"
        ],
        [
            27,
            "ΠΟΥΛΕΤΣΟΣ ΑΝΔΡΕΑΣ",
            "ΠΕ79.01",
            null,
            null,
            "Β1 Μσκ",
            null,
            "Γ5 Εργ",
            null,
            "Α1 Μσκ",
            "Β3 Μσκ",
            "Β3 Εργ",
            null,
            "Γ4Μσκ",
            "Β4 Μσκ",
            null,
            null,
            null,
            "Γ2 Εργ",
            null,
            "Γ4 εργ",
            "Γ5 Μσκ",
            null,
            null,
            null,
            null,
            null,
            "Α2 Μσκ",
            "Γ3 Μσκ",
            "Α4 Μσκ",
            "Γ1 Μσκ",
            "Β2 Μσκ",
            "Α3 Μσκ",
            "Γ2 Μσκ",
            null,
            "Γ1 Εργ",
            "Γ3 Εργ"
        ],
        [
            28,
            "ΕΞΑΡΧΟΥ ΕΥΗ",
            "ΠΕ88.02",
            "Α3ΠΤ1 Τχν",
            "Β4ΠΤ1 Τχν",
            "Α1ΠΤ1 Τχν",
            "Β2ΠΤ2 Τχν",
            null,
            "Γ1ΠΤ2 Τχν",
            null,
            "Β1 Τχν",
            null,
            null,
            "Γ2 Τχν",
            "Β3ΠΤ2 Τχν",
            "Γ5 Τχν",
            null,
            null,
            "Γ1ΠΤ1 Τχν",
            "Γ3ΠΤ2 Τχν",
            "Α4ΠΤ2 Τχν",
            null,
            null,
            "Α2ΠΤ2 Τχν",
            null,
            "Α3ΠΤ2 Τχν",
            "Α1ΠΤ2 Τχν",
            null,
            "Α2ΠΤ1 Τχν",
            "Β4ΠΤ2 Τχν",
            "Α4ΠΤ1 Τχν",
            "Γ4 Τχν",
            "Β3ΠΤ1 Τχν",
            null,
            null,
            "Γ3ΠΤ1 Τχν",
            "Β2ΠΤ1 Τχν"
        ],
        [
            29,
            "ΠΙΤΟΥ ΜΑΡΙΑ",
            "ΠΕ86",
            "Α3ΠΤ2 Πλρ",
            "Β4ΠΤ2 Πλρ",
            "Α1ΠΤ2 Πλρ",
            null,
            null,
            null,
            null,
            "Α2ΠΤ2 Πλρ",
            "Α3ΠΤ2 Πλρ",
            "Α4ΠΤ1 Πλρ",
            null,
            "Β3ΠΤ1 Πλρ",
            "Α1ΠΤ2 Πλρ",
            null,
            null,
            null,
            null,
            "Α4ΠΤ1 Πλρ",
            "Α4ΠΤ2 Πλρ",
            "Α2ΠΤ1 Πλρ",
            "Α2ΠΤ1 Πλρ",
            null,
            "Α3ΠΤ1 Πλρ",
            "Α1ΠΤ1 Πλρ",
            null,
            "Α2ΠΤ2 Πλρ",
            "Β4ΠΤ1 Πλρ",
            "Α4ΠΤ2 Πλρ",
            null,
            "Β3ΠΤ2 Πλρ",
            "Α1ΠΤ1 Πλρ",
            "Α3ΠΤ1 Πλρ"
        ],
        [
            30,
            "ΣΦΥΡΗ ΚΡΥΣΤΑΛΛΙΑ",
            "ΠΕ86",
            null,
            null,
            null,
            "Β2ΠΤ1 Πλρ",
            "Γ4 Πλρ",
            "Γ1ΠΤ1 Πλρ",
            "Γ5 Πλρ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Β1 Πλρ",
            "Γ1ΠΤ2 Πλρ",
            "Γ3ΠΤ1 Πλρ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ2 Πλρ",
            "B4 ΕΡΓ",
            null,
            "B1 Εργ",
            "Γ3ΠΤ2 Πλρ",
            "Β2ΠΤ2 Πλρ"
        ],
        [
            31,
            "ΜΗΤΡΟΥΣΙΑ ΚΩΝΣΤΑΝΤΙΝΙΑ",
            "ΠΕ02",
            "Γ3 ΑρχΚμ",
            "Β3 ΑρχΓλ",
            "Γ4 ΑρχΚμ",
            "Γ3 ΑρχΓλ",
            null,
            "Γ4 ΚΠΑ",
            "Β3 ΓΛ",
            null,
            null,
            "Β3 ΓΛ",
            "Γ5 ΑΡΧΚ",
            "Γ5 ΑρχΓλ",
            "Γ3 ΑρχΚμ",
            null,
            "Γ4 Γλω",
            "Β3 ΑρχΚμ",
            "Γ4 Γλω",
            "Γ5 ΑΡΧΚ",
            "Γ4 ΑρχΚμ",
            null,
            "Γ3 ΑρχΓλ",
            null,
            "Γ4 ΑρχΓλ",
            "Γ5 Γλω",
            null,
            null,
            null,
            null,
            "Β3 ΑρχΚμ",
            "Γ5 Γλω",
            "Γ5 ΑρχΓλ",
            "Β3 ΑρχΓλ",
            null,
            "Γ4 ΑρχΓλ"
        ],
        [
            32,
            "ΝΑΚΗ ΣΤΕΛΛΑ",
            "ΠΕ02",
            null,
            "Γ3 Ιστ",
            "Γ3 ΚΠΑ",
            null,
            "Γ3 ΝΕΛ",
            "Β3 Ιστ",
            "Γ4 ΝεΛ",
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            "Γ3 Ιστ",
            "Γ4 ΝΕΛ",
            null,
            "Γ3 ΝεΛ",
            "Γ3 ΚΠΑ",
            "Β3 Ιστ",
            "Γ5 Ιστ",
            "Γ4 Ιστ",
            "Β3 ΝεΛ"
        ],
        [
            33,
            "ΘΕΟΛΟΓΙΤΗ ΜΑΡΙΑ ΕΛΕΝΗ ΛΟΥΙΖΑ",
            "ΠΕ04.02",
            null,
            "Γ5 Βιο",
            "Γ5 Φσκ",
            null,
            "Γ4 Πλρ",
            null,
            null,
            "Γ3 Βιο",
            "Γ5 Φσκ",
            "Γ4 Φσκ",
            "Γ4 Μσκ",
            null,
            "Γ5 Τχν",
            null,
            null,
            null,
            "Β3 Φσκ",
            "Β3 Γεω",
            null,
            "Γ4 Βιο",
            null,
            "Β3 Βιο",
            "Γ5 Χημ",
            null,
            "Γ4 Χημ",
            "Γ3 Μσκ",
            "Β3 Φσκ",
            "Γ3 Χημ",
            "Γ3 Φσκ",
            "Γ3 Φσκ",
            "Β3 Χημ",
            "Γ4 Φσκ",
            "Γ3ΠΤ1 Πλρ",
            "Β3 Γεω"
        ],
        [
            34,
            "ΚΑΡΚΑΛΕΤΣΗ ΓΕΩΡΓΙΑ",
            "ΠΕ03",
            null,
            "Γ4 Μαθ",
            "Β3 Μαθ",
            null,
            "Γ5 Εργ",
            "Γ5 Μαθ",
            "Γ3 Μαθ",
            "Β3 Μσκ",
            "Γ4 Μαθ",
            "Γ5 ΜΑΘ",
            null,
            "Β3ΠΤ2 Τχν",
            "Β3 Μαθ",
            null,
            "Γ5 Μαθ",
            null,
            "Γ3ΠΤ2 Τχν",
            "Γ4 Εργ",
            "Γ5 Μσκ",
            null,
            null,
            "Γ3 Μαθ",
            "Γ3 Μαθ",
            null,
            "Β3 Μαθ",
            null,
            "Γ4 Μαθ",
            null,
            "Γ5 Μαθ",
            "Γ4 Μαθ",
            "Γ3 Μαθ",
            null,
            "Β3 Μαθ",
            "Γ3 Εργ"
        ]
    ];
    const replacements = {
        'ΑρχΓλ': 'Αρχαία',
        'ΑρΓΛ': 'Αρχαία',
        'Αρχ Γλ': 'Αρχαία',
        'Γαλ': 'Γαλλικά',
        'Γερ': 'Γερμανικά',
        'Μαθ': 'Μαθηματικά',
        'Εργ': 'Εργαστήριο Δεξιοτήτων',
        'Γλω': 'Γλώσσα',
        'ΝεΛ': 'Λογοτεχνία',
        'Αγγ': 'Αγγλικά',
        'ΑρχΚμ': 'Οδύσσεια',
        'ΑρΚμ': 'Οδύσσεια',
        'Γεω': 'Γεωγραφία',
        'Ιστ': 'Ιστορία',
        'Καλ': 'Εικαστικά',
        'Θρσ': 'Θρησκευτικά',
        'Βιο': 'Βιολογία',
        'Φσκ': 'Φυσική',
        'Γμν': 'Γυμναστική',
        'Οικ': 'Οικιακή Οικονομία',
        'Πλρ': 'Πληροφορική',
        'Τχν': 'Τεχνολογία',
        'Μσκ': 'Μουσική'
    };

    const getOnload = selectedClass => function (e) {
        let rows;
        if (e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            rows = XLSX.utils.sheet_to_json(sheet, {header: 1});
        } else {
            rows = defaultData;
        }


        const table = Array.from({length: 7}, () => Array(5).fill(''));
        let currentDay = -1;
        let currentHour = -1;

        const maxCols = rows.reduce((max, row) => Math.max(max, row.length), 0);

        currentDay = -1;
        currentHour = -1;

        for (let col = 0; col < maxCols; col++) {
            for (let row = 0; row < rows.length; row++) {
                const cellValue = (rows[row][col] || '').toString().trim();

                switch (cellValue) {
                    case 'ΔΕΥΤΕΡΑ':
                        currentDay = 0;
                        break;
                    case 'ΤΡΙΤΗ':
                        currentDay = 1;
                        break;
                    case 'ΤΕΤΑΡΤΗ':
                        currentDay = 2;
                        break;
                    case 'ΠΕΜΠΤΗ':
                        currentDay = 3;
                        break;
                    case 'ΠΑΡΑΣΚΕΥΗ':
                        currentDay = 4;
                        break;
                    case '1η':
                        currentHour = 0;
                        break;
                    case '2η':
                        currentHour = 1;
                        break;
                    case '3η':
                        currentHour = 2;
                        break;
                    case '4η':
                        currentHour = 3;
                        break;
                    case '5η':
                        currentHour = 4;
                        break;
                    case '6η':
                        currentHour = 5;
                        break;
                    case '7η':
                        currentHour = 6;
                        break;
                    default:
                        if (currentDay !== -1 && currentHour !== -1) {
                            const greekA = 'Α';
                            const classPrefix = selectedClass.startsWith('A') ?
                                [selectedClass, greekA + selectedClass.slice(1)] :
                                [selectedClass];

                            if (classPrefix.some(prefix => cellValue.startsWith(prefix))) {
                                const processedValue = processCellValue(cellValue, classPrefix);
                                if (table[currentHour][currentDay]) {
                                    table[currentHour][currentDay] += '\n' + processedValue;
                                } else {
                                    table[currentHour][currentDay] = processedValue;
                                }
                            }
                        }
                }
            }
        }

        displaySchedule(table);
    };

    function convert(first = false) {
        const fileInput = document.getElementById('fileInput');
        const classroomSelect = document.getElementById('classroomSelect');
        const selectedClass = classroomSelect.value;
        const file = fileInput.files[0];

        if (!file) {
            first = true;
        }

        if (!first) {
            const reader = new FileReader();
            reader.onload = getOnload(selectedClass);
            reader.readAsArrayBuffer(file);
        } else {
            getOnload(selectedClass)(false);
        }
    }

    function processCellValue(value, prefixes) {
        return value.split(' ')
            .filter(token => !prefixes.some(prefix => token.startsWith(prefix)))
            .map(token => replacements[token] || token)
            .join(' ');
    }

    function displaySchedule(table) {
        const days = ['ΔΕΥΤΕΡΑ', 'ΤΡΙΤΗ', 'ΤΕΤΑΡΤΗ', 'ΠΕΜΠΤΗ', 'ΠΑΡΑΣΚΕΥΗ'];
        let html = '<table class="schedule-table"><thead><tr><th>Ώρα</th>';

        days.forEach(day => html += `<th>${day}</th>`);
        html += '</tr></thead><tbody>';

        for (let hour = 0; hour < 7; hour++) {
            html += `<tr><td>${hour + 1}η</td>`;
            for (let day = 0; day < 5; day++) {
                html += `<td>${table[hour][day].replace(/\n/g, '<br>')}</td>`;
            }
            html += '</tr>';
        }

        html += '</tbody></table>';
        document.getElementById('schedule').innerHTML = html;
    }
</script>
</body>
</html>
